<div class="page-header">
    <div class="page-leftheader">
      <h4 class="page-title"> Gestión de Papeles </h4>
    </div>
    <div class="page-rightheader ms-auto d-lg-flex d-none">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a class="d-flex"
            ><svg
              class="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              height="24"
              viewBox="0 0 24 24"
              width="24"
            >
              <path d="M0 0h24v24H0V0z" fill="none" />
              <path
                d="M12 3L2 12h3v8h6v-6h2v6h6v-8h3L12 3zm5 15h-2v-6H9v6H7v-7.81l5-4.5 5 4.5V18z"
              />
              <path d="M7 10.19V18h2v-6h6v6h2v-7.81l-5-4.5z" opacity=".3" /></svg><span class="breadcrumb-icon"> Home</span></a
          >
        </li>
        <li class="breadcrumb-item"><span>Fisicos</span></li>
        <li class="breadcrumb-item">Papeles</li>
        <li class="breadcrumb-item active" aria-current="page"> Gestión de Papeles</li>
      </ol>
    </div>
  </div>
  
  <div class="row row-deck">
          <div class="container">
                  <div class="row">
                          <div class="col-xl-4 col-lg-6 col-md-6">
                                  <div class="card">
                                          <div class="card-body">
                                                  <div class="row">
                                                          <div class="col-xl-6 col-lg-6 col-md-6">
                                                                  <label class="form-label">Sociedad <span class="text-red">*</span></label>
                                                                  <ng-select class="form-control form-select" [(ngModel)]="sociedadSelected" (change)="onSelectSociedad($event)">
                                                                    <ng-option value={{sociedad.s204_ID}} *ngFor="let sociedad of sociedades">
                                                                          {{sociedad.s204_Description}} </ng-option>
                                                                  </ng-select>
                                                          </div>
                                                          <div class="ccol-xl-6 col-lg-6 col-md-6">
                                                                  <label class="form-label">Subyacente<span
                                                                                  class="text-red">*</span></label>
                                                                  <ng-select class="form-control form-select" [(ngModel)]="subyacenteSelected" (change)="aplicarFiltro()">
                                                                          <ng-option value={{producto.s204_ID}}
                                                                                  *ngFor="let producto of subyacentes" [hidden]="producto.s204_ID == 0">{{producto.s204_Description}} </ng-option>
                                                                  </ng-select>
                                                          </div>
                                                  </div>
                                          </div>
                                  </div>
                          </div>
                          <div class="col-xl-3 col-lg-4 col-md-4">
                                  <div class="card">
                                          <div class="card-body">
                                                  <div class="row">
                                                  <div class="col-xl-5 col-lg-6 col-md-6">
                                                          <button type="button" class="btnresponsive btn btn-white "
                                                                  id='b1' aria-expanded="false"
                                                                  (click)="cerrarPortafolioModal(cierreMolienda)"><i class="fa fa-lock"></i>
                                                                  Realizar Cierre</button>
                                                  </div>
                                                  <div class="col-xl-5 col-lg-6 col-md-6">
                                                          <button type="button" class="btnresponsive btn btn-white "
                                                                  id='b1' aria-expanded="false"
                                                                  (click)="deshacerCierrePortafolioModal(cierreMolienda)"><i class="fa fa-unlock"></i>
                                                                  Deshacer Cierre</button>
                                                  </div>
                                                  </div>
                                          </div>
                                  </div>
                          </div>
                          <div class="col-xl-2 col-lg-3 col-md-4">
                                  <div class="card">
                                          <div class="card-body">
                                                  <div class="row" >
                                                          <strong style="font-size: 1.5em; border: 1px solid rgb(103, 174, 37); border-radius: 4px; padding: 2px;line-height: 2.7 ;text-align: center; display: inline-block;"> M2M : {{ m2m }} </strong>
                                                  </div>
                                          </div>
                                  </div>
                          </div>
                          <div class="col-xl-2 col-lg-3 col-md-4">
                                  <div class="card">
                                          <div class="card-body">
                                                     <div class="center" >
                                                          <button type="button" class="btnresponsive btn btn-white "
                                                          id='b1' aria-expanded="false"
                                                          (click)="modalgenerarReporte(consultaHistorica)">Reporte Papeles</button>
                                                  </div>
                                                
                                                  
                                          </div>
                                  </div>
                          </div>
                  </div>
          </div>
  </div>
  <mat-tab-group [(selectedIndex)]="seleccionaIndiceTab" class="compact-tabs" animationDuration="500ms" >
   <mat-tab label="PORTAFOLIO">
          <div class="card">
                  <div class="card-header">
                          <div class="btn-group ms-1 mb-0 justify-content-start">
                                  <div class="">
                                          <div *ngIf="estadoPortafolio.length <= 0" class="row">
                                                  <h5 class="mb-0"><i class="fa fa-check-circle"
                                                                  style="font-size:180%;color:green"></i>
                                                          PORTAFOLIO ABIERTO</h5>
                                          </div>
                                          <div *ngIf="estadoPortafolio.length > 0" class="row">
                                                  <h5><i class="fa fa-times-circle"
                                                                  style="font-size:180%;color:red"></i>
                                                          PORTAFOLIO CERRADO</h5>
                                          </div>
                                  </div>
                          </div>
  
                          <div class="card-options" ngbDropdown>
  
  
                                  <div class="btn-group ms-5 mb-0">
                                          <button type="button" class="btn btn-white"
                                                  aria-expanded="false" data-toggle="modal"
                                                  (click)="modalIngresarPapel(IngresarPapel)">
                                                  <i class="fe fe-plus"></i>Agregar Papel
                                          </button>
                                  </div>
                          </div>
                  </div>
                  <div class="card-body">
                          <div class="table-responsive">
  
                                  <div class="tabla-table-container">
                                          <table mat-table #sortPortafolioInventario="matSort" class="table table-bordered text-nowrap"
                                                  class="example-table table-bordered" matSort matSortActive="created" matSortDisableClear
                                                  matSortDirection="desc" style="width:100%" [dataSource]="listaPapelesAbiertosDS">
  
                                                  <ng-container class="border-bottom-0" matColumnDef="s133_Codigo" sticky>
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Papel </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles" class="minegrita">
                                                          {{elementoPapeles.s133_Codigo}}</td>
                                                  </ng-container>
                                                  <ng-container class="border-bottom-0"matColumnDef="s133_Fecha">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Fecha </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles"> {{elementoPapeles.s133_Fecha | date: "dd/MM/yyyy"}}</td>
                                                  </ng-container>
                                                  <ng-container class="border-bottom-0" matColumnDef="s133_CompraVenta">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Compra / Venta</th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_CompraVenta}} </td>
                                                  </ng-container>
                                                  <ng-container class="border-bottom-0" matColumnDef="s133_Contraparte">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Contraparte</th> 
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Contraparte}}</td>
                                                  </ng-container>
                                                  <ng-container class="border-bottom-0" matColumnDef="s133_ContratoExterno">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Contrato Externo </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_ContratoExterno }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Origen">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Origen </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Origen}} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Desde">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Desde</th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Desde | date: "dd/MM/yyyy"}}</td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Hasta">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Hasta </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Hasta | date: "dd/MM/yyyy"}}</td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_TM">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Total TM </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_TM| number: '1.0-0'}}</td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Saldo">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Saldo TM </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Saldo| number: '1.0-0'}}</td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Incoterm">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Incoterm </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{elementoPapeles.s133_Incoterm }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Precio">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Precio </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Precio | number: '1.2-2'}} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_ContratoFuturo">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Contrato Futuro </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_ContratoFuturo }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Indice">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Indice </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Indice }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Campagna">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Campaña </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Campagna }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Observaciones">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Observaciones </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Observaciones }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Benchmark">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Benchmark </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Benchmark| number: '1.2-2' }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_M2M">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> M2M </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles" [ngStyle]="{'color': elementoPapeles.s133_M2M < 0 ? 'red' : 'blue'}">{{ elementoPapeles.s133_M2M| number: '1.2-2' }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Cobertura">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Cobertura </th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Cobertura }} </td>
                                                  </ng-container>
                                                  <ng-container matColumnDef="s133_Hedge">
                                                          <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Cobertura Estratégica</th>
                                                          <td mat-cell *matCellDef="let elementoPapeles">{{ elementoPapeles.s133_Hedge }} </td>
                                                  </ng-container>
  
                                                  <tr mat-header-row
                                                          *matHeaderRowDef="columnsPapelesAbiertos sticky: true"
                                                          style="text-align: center; vertical-align: middle;">
                                                  </tr>
  
                                                  <tr class="tbody" (contextmenu)="onContextMenu($event,false, elementoPapeles.s133_Codigo)" mat-row
                                                          *matRowDef="let elementoPapeles; columns: columnsPapelesAbiertos;"
                                                          style="text-align: center; vertical-align: middle;"
                                                          [class.selected]="elementoPapeles.selected"
                                                          (click)="elementoPapeles.selected= !elementoPapeles.selected">
                                                  </tr>
                                          </table>
                                  </div>
                          </div>
                  </div>
          </div>
  </mat-tab>
  <mat-tab label="REPORTE"> 
          <div class="card-body">   
          <div class="table-responsive">     
          <div class="table-container" >
                                  <table mat-table  #sortPortafolioInventario="matSort" class="table table-bordered text-nowrap"
                                  class="example-table table-bordered" matSort matSortActive="created" matSortDisableClear
                                  matSortDirection="desc" style="width:100%" [dataSource]="listaReportePaperDS">
  
                                          <ng-container  matColumnDef="s138_Codigo" sticky>
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Papel </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Codigo',i)" [style.display]="getRowSpan('s138_Codigo',i)?'':'none'"                                             
                                                  class="minegrita"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Codigo')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Codigo')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Codigo')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Codigo}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Fecha">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red"> Fecha </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Fecha',i)" [style.display]="getRowSpan('s138_Fecha',i)?'':'none'"  
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Fecha')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Fecha')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Fecha')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip" 
                                                  >{{elreportepapel.s138_Fecha| date: "dd/MM/yyyy"}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_CompraVenta">
                                                  <th mat-header-cell *matHeaderCellDef  mat-sort-header class="header-red"> Compra/Venta </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_CompraVenta',i)" [style.display]="getRowSpan('s138_CompraVenta',i)?'':'none'"   
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_CompraVenta')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_CompraVenta')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_CompraVenta')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_CompraVenta}}</td>
                                          </ng-container>                                        
                                          <ng-container   matColumnDef="s138_Sociedad" >
                                                  <th mat-header-cell *matHeaderCellDef  mat-sort-header class="header-red">Sociedad </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Sociedad',i)" [style.display]="getRowSpan('s138_Sociedad',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Sociedad')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Sociedad')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Sociedad')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Sociedad}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Subyacente">
                                                  <th mat-header-cell *matHeaderCellDef  mat-sort-header class="header-red">Subyacente </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Subyacente',i)" [style.display]="getRowSpan('s138_Subyacente',i)?'':'none'"   
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Subyacente')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Subyacente')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Subyacente')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Subyacente}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Contraparte">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Contraparte </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Contraparte',i)" [style.display]="getRowSpan('s138_Contraparte',i)?'':'none'"   
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Contraparte')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Contraparte')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Contraparte')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Contraparte}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_ContratoExterno">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Contrato Externo </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_ContratoExterno',i)" [style.display]="getRowSpan('s138_ContratoExterno',i)?'':'none'"   
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_ContratoExterno')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_ContratoExterno')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_ContratoExterno')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_ContratoExterno}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Estado">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Estado </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Estado',i)" [style.display]="getRowSpan('s138_Estado',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Estado')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Estado')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Estado')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Estado}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Origen">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Origen </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Origen',i)" [style.display]="getRowSpan('s138_Origen',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Origen')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Origen')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Origen')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Origen}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Desde">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Desde </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Desde',i)" [style.display]="getRowSpan('s138_Desde',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Desde')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Desde')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Desde')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Desde| date: "dd/MM/yyyy"}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Hasta">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Hasta </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Hasta',i)" [style.display]="getRowSpan('s138_Hasta',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Hasta')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Hasta')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Hasta')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Hasta| date: "dd/MM/yyyy"}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_TM">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">TM </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_TM',i)" [style.display]="getRowSpan('s138_TM',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_TM')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_TM')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_TM')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_TM| number: '1.0-0'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Saldo">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Saldo </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Saldo',i)" [style.display]="getRowSpan('s138_Saldo',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Saldo')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Saldo')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Saldo')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Saldo| number: '1.0-0'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Incoterm">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Incoterm </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Incoterm',i)" [style.display]="getRowSpan('s138_Incoterm',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Incoterm')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Incoterm')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Incoterm')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Incoterm}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Precio">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Precio </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Precio',i)" [style.display]="getRowSpan('s138_Precio',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Precio')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Precio')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Precio')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Precio| number: '1.2-2'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_ContratoFuturo">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Contrato Futuro </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_ContratoFuturo',i)" [style.display]="getRowSpan('s138_ContratoFuturo',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_ContratoFuturo')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_ContratoFuturo')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_ContratoFuturo')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_ContratoFuturo}}</td>
                                          </ng-container>
                                          <ng-container matColumnDef="s138_Campagna">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Campaña </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Campagna',i)" [style.display]="getRowSpan('s138_Campagna',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Campagna')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Campagna')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Campagna')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Campagna}}</td>
                                          </ng-container>
                                          <ng-container matColumnDef="s138_Hedge">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Cobertura Estratégica</th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Hedge',i)" [style.display]="getRowSpan('s138_Hedge',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Hedge')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Hedge')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Hedge')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Hedge}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Observaciones">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-red">Observaciones </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [attr.rowspan]="getRowSpan('s138_Observaciones',i)" [style.display]="getRowSpan('s138_Observaciones',i)?'':'none'"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Observaciones')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Observaciones')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Observaciones')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Observaciones}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_CodigoLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">Codigo </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" class="minegrita"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_CodigoLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_CodigoLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_CodigoLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip">{{elreportepapel.s138_CodigoLiquidacion}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_CompraVentaLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">Compra/Venta </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_CompraVentaLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_CompraVentaLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_CompraVentaLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_CompraVentaLiquidacion}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_ContratoExternoLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">Contrato Externo </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_ContratoExternoLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_ContratoExternoLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_ContratoExternoLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip">{{elreportepapel.s138_ContratoExternoLiquidacion}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_FechaLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">Fecha </th>
                                                  <td mat-cell *matCellDef="let elreportepapel,let i =index"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_FechaLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_FechaLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_FechaLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip">{{elreportepapel.s138_FechaLiquidacion| date: "dd/MM/yyyy"}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_TMLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">TM </th>
                                                  <td mat-cell *matCellDef="let elreportepapel; let i = index" 
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_TMLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_TMLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_TMLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                
                                                          >{{elreportepapel.s138_TMLiquidacion|number: '1.0-0'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_PrecioLiquidacion">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">Precio </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_PrecioLiquidacion')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_PrecioLiquidacion')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_PrecioLiquidacion')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip">{{elreportepapel.s138_PrecioLiquidacion|number: '1.2-2'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_PnL">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue">P&L USD </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i=index" [ngStyle]="{'color': elreportepapel.s138_PnL < 0 ? 'red' : 'blue'}"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_PnL')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_PnL')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_PnL')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_PnL|number: '1.2-2'}}</td>
                                          </ng-container>
                                          <ng-container  matColumnDef="s138_Comentarios">
                                                  <th mat-header-cell *matHeaderCellDef mat-sort-header class="header-blue" >Comentarios </th>
                                                  <td mat-cell *matCellDef="let elreportepapel;let i = index"
                                                  [class.selected]="esCeldaSeleccionada(i, 's138_Comentarios')"
                                                  (mousedown)="empezarseleccion($event, i, 's138_Comentarios')"
                                                  (mousemove)="adicionar_a_seleccion($event, i, 's138_Comentarios')"
                                                  (mouseup)="finalizarSeleccion()"
                                                  [matTooltip]="tooltipText"
                                                  matTooltipPosition="right"
                                                  matTooltipClass="multiline-tooltip"
                                                  >{{elreportepapel.s138_Comentarios}}</td>
                                          </ng-container>             
                                          
                                                              <!-- Header para Encabezado Papel -->       
                                         <!-- <ng-container matColumnDef="header-row-first-group">
                                                     <th mat-header-cell *matHeaderCellDef [style.text-align]="center" [attr.colspan]="18" mat-sort-header class="header-red" > Papel</th>
                                         </ng-container>       -->
                                                            <!-- Header para Encabezado Liquidacion -->
                                         <!-- <ng-container matColumnDef="header-row-second-group">
                                                     <th mat-header-cell *matHeaderCellDef [attr.colspan]="8"  mat-sort-header class="header-blue" > Liquidación </th>
                                         </ng-container> -->
  
                                         <!-- <tr mat-header-row *matHeaderRowDef="['header-row-first-group', 'header-row-second-group'] sticky: true"></tr>     -->
  
                                          <tr mat-header-row  *matHeaderRowDef="columnsReportePapeles sticky: true"   style="text-align: center; vertical-align: middle;"  ></tr>
  
                                          <tr class="tbody" (contextmenu)="onContextMenu($event,true ,elreportepapel.s138_Codigo)" mat-row  *matRowDef="let elreportepapel; columns: columnsReportePapeles;"
                                                  style="text-align: center; vertical-align: middle;" [class.selected]="elreportepapel.selected" (click)="elreportepapel.selected= !elreportepapel.selected">
                                          </tr>
                                  </table>
                                  </div>
          </div>
             </div>
                         
  </mat-tab>
  
  </mat-tab-group>
  
  <div
          style="visibility: hidden; position: fixed"
          [style.left]="contextMenuPosition.x"
          [style.top]="contextMenuPosition.y"
          [matMenuTriggerFor]="menuTriggerOpen">
  </div>
  <mat-menu #menuTriggerOpen="matMenu">
          <ng-template matMenuContent let-item="item">
                  <button mat-menu-item *ngIf="!isSecondTable" (click)="modalModificarPapel(IngresarPapel)">Modificar</button>       
                  <button mat-menu-item *ngIf="!isSecondTable" (click)="modalLiquidarPapel(LiquidarPapel)">Liquidar</button>       
                  <button mat-menu-item (click)="modalListaLiquidacion(ListaLiquidacion)">Mostrar Liquidaciones</button>       
                  <button mat-menu-item *ngIf="!isSecondTable" (click)="cancelarPapel()">Cancelar</button> 
                  <button mat-menu-item *ngIf="!isSecondTable" (click)="ModalduplicarContrato()">Duplicar</button>      
                  <!-- <button mat-menu-item (click)="pasarTransito(PasarTransito)">Mover a Transito</button>       
                  <button mat-menu-item [matMenuTriggerFor]="bases">Bases</button>           
                  <button mat-menu-item [matMenuTriggerFor]="pricing">Futuros</button>            -->
          </ng-template>
  </mat-menu>
  
  <ng-template #IngresarPapel let-modal >
          <app-ingresar-papeles (closegestionPapel)="cerrarModalPapel(modal)" [objForm] = "objDatosForm"  [subyacenteSelected] = "subyacenteSelected" [sociedadSelected] = "sociedadSelected" (papelGuardado)="obtenerPortafolio()"></app-ingresar-papeles>
  </ng-template>
  <ng-template #LiquidarPapel let-modal >
          <app-liquidar-papeles (closeLiquidarPapel)="cerrarModalPapel(modal)" [objLiquidar] = "objLiquidarPadre" (papelGuardado)="obtenerPortafolio()" ></app-liquidar-papeles>
  </ng-template>
  <ng-template #ListaLiquidacion let-modal >
          <app-lista-liquidaciones (closeListaLiquidaciones)="cerrarModalPapel(modal)"  [listaLquidacionesHijo] = "liquidacionesPadre" [subyacenteSelected] = "subyacenteSelected" [sociedadSelected] = "sociedadSelected" (papelGuardado)="obtenerPortafolio()"></app-lista-liquidaciones>
  </ng-template>
  <!-- <div echarts [options]="chartOption" class="demo-chart" style="height: 600px;width: 600px;"></div> -->
  
  <ng-template #cierreMolienda let-modal>
          <div role="document" > <!--class="msg_card_body" -->
            <div class="modal-header">
              <h5 *ngIf="!flgDeshacerCierre" class="modal-title">Realizar Cierre de {{ SociedadString }}</h5>
              <h5 *ngIf="flgDeshacerCierre" class="modal-title">Deshacer Cierre de {{ SociedadString }}</h5>
              <button type="button" class="close" aria-label="Close"  (click)="modal.dismiss('Cross click')"><mat-icon>close</mat-icon></button>
            </div>
            <div class="modal-body">
              <div class="py-1">
                <ul class="row">
                  <li class="col text-center">
                    <h4 > Subyacente </h4>
                  </li>
                  <li class="col text-center">
                    <h4 *ngIf="!flgDeshacerCierre"> Cerrar </h4>
                    <h4 *ngIf="flgDeshacerCierre"> DeshacerCierre </h4>
                  </li>
                  <li class="col text-center">
                    <h4 > Estado </h4>
                  </li>
                  <li class="col text-center">
                    <h4 > Hora de Cierre </h4>
                  </li>
                </ul>
                <ul class="row">
                  <li class="col text-center">
                    Seleccionar Todo
                  </li>
                  <li class="col text-center">
                    <mat-checkbox class="checkCierre"  [(ngModel)]="seleccionarTodo" (change)="seleccionarTodoCierre()"></mat-checkbox>
                  </li>
                  <li class="col ">
                   
                  </li>
                  <li class="col ">
                   
                  </li>
                  
                </ul>
                  <ul *ngFor="let item of listaCierrePapeles" class="row">
                    <li class="col text-center">
                      <h5 >{{item.desc_Subyacente}}</h5>
                    </li>
        
                    <li class="col text-center" *ngIf="!flgDeshacerCierre">
                      <mat-checkbox class="checkCierre"  [(ngModel)]="item.flgCerrar"  [disabled]="!item.flgEstado"></mat-checkbox>
                    </li>
                    <li class="col text-center" *ngIf="flgDeshacerCierre">
                      <mat-checkbox class="checkCierre"  [(ngModel)]="item.flgCerrar"  [disabled]="item.flgEstado"></mat-checkbox>
                    </li>
        
                    <li class="col text-center" *ngIf="!flgDeshacerCierre && !flgLoadingCierres">
                      <i *ngIf="item.flgEstado"  class="fa fa-check-circle"style="font-size:180%;color:green"></i>
                      <!-- <i *ngIf="!item.flgEstado" class="fa fa-times-circle"style="font-size:180%;color:red"></i> -->
                      <i *ngIf="!item.flgEstado" class="fa fa-exclamation-circle"style="font-size:180%;color:orange"></i>
                    </li>
                    <li class="col text-center" *ngIf="flgDeshacerCierre && !flgLoadingCierres">
                      <i *ngIf="!item.flgEstado"  class="fa fa-check-circle"style="font-size:180%;color:green"></i>
                      <!-- <i *ngIf="!item.flgEstado" class="fa fa-times-circle"style="font-size:180%;color:red"></i> -->
                      <i *ngIf="item.flgEstado" class="fa fa-exclamation-circle"style="font-size:180%;color:orange"></i>
                    </li>
                    <li class="col text-center" *ngIf="flgLoadingCierres">
                      <i class="fa fa-spinner" style="font-size:180%;" aria-hidden="true"></i>
                    </li>
                    
                    <li class="col  text-center" >
                      <a>{{item.horacierreString}}</a>
                    </li>
                  </ul>
                  
                <!-- </form> -->
              </div>
            </div>
            <div class="modal-footer">
              <span class="br"></span>
              <div class="col justify-content-start" *ngIf="!flgDeshacerCierre">
                <div class="row"> <a ><i class="fa fa-check-circle"style="font-size:100%;color:green"></i> Habilitado para cerrar</a> </div>
                <div class="row"><a><i class="fa fa-exclamation-circle"style="font-size:100%;color:orange"></i> Deshabilitado para cerrar</a></div>
              </div>
              <div class="col justify-content-start" *ngIf="flgDeshacerCierre">
                <div class="row"> <a ><i class="fa fa-check-circle"style="font-size:100%;color:green"></i> Habilitado para deshacer cierre</a> </div>
                <div class="row"><a><i class="fa fa-exclamation-circle"style="font-size:100%;color:orange"></i> Deshabilitado para deshacer cierre</a></div>
              </div>
            
                  <!-- <a><i class="fa fa-check-circle"style="font-size:100%;color:red"></i></a>  -->
        
                  <span class="br"></span>
                  <div class="row">
                    <div class="col d-flex justify-content-end" *ngIf="!flgDeshacerCierre">
                      <button
                        class="btn btn-green"
                        type="submit"
                        [disabled]="!flgBontongenerico"
                        (click)="cerrarPortafolio()">
                        Aceptar
                      </button>
                    </div>
                    <div class="col d-flex justify-content-end" *ngIf="flgDeshacerCierre">
                      <button
                        class="btn btn-green"
                        type="submit"
                        [disabled]="!flgBontongenerico"
                        (click)="deshacerPortafolio()">
                        Aceptar
                      </button>
                    </div>
                  </div>
          </div>
          </div>
        </ng-template>
  
        <ng-template #consultaHistorica let-modal>
          <div role="document" > <!--class="msg_card_body" -->
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Reporte Papeles</h5>
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')" >
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="modal-body">
                <div class="py-1">
                  <form class="form" novalidate="">
                    <div class="row">
                      <div class="col col-xl-12 col-lg-21 col-md-12">
                        <div class="row">
                          <div class="col-xl-4 col-lg-4 col-md-4">
                            <label class="form-label">Campaña:</label>
                          </div>
                          <div class="col-xl-8 col-lg-8 col-md-8">
                            <ng-select class="form-control form-select" name="campagnasSeleccionadas"  [(ngModel)]="campaniaSelected">
                              <ng-option  value="{{ item.s204_ID }}"  *ngFor="let item of listacampania">{{ item.s204_Description }}</ng-option>
                            </ng-select>
                          </div>
                        </div>
                        <span class="br"></span>
                        <div class="row">
                          <div class="col-xl-4 col-lg-4 col-md-4">
                            <label class="form-label">Sociedad:</label>
                          </div>
                          <div class="col-xl-8 col-lg-8 col-md-8">
                            <ng-select class="form-control form-select"   name="ConsultaSociedad"  [(ngModel)]="ConsultaSociedadselected" >
                            <ng-option value="{{ item.s204_ID }}" *ngFor="let item of combosociedades">{{ item.s204_Description }}</ng-option>
                            </ng-select>
                          </div>
                        </div>
                        <span class="br"></span>
                        <div class="row">
                          <div class="col-xl-1 col-lg-2 col-md-1">
                            <mat-checkbox class="checkCierre" name="flgFechaConsultaHistorica" [(ngModel)]="flgFechaConsultaHistorica"  ></mat-checkbox>
                          </div>                        
                          <div class="col-xl-1 col-lg-4 col-md-1">
                            <label class="form-label">Fecha Inicio:</label>
                          </div>
                          <div class="col-xl-4 col-lg-4 col-md-4">
                            <input class="form-control" type="date" placeholder="yyyy-mm-dd" [(ngModel)]="fechInicio" ngbDatepicker
                              (click)="d1.toggle()"  #d1="ngbDatepicker"  name="t218_Date" readonly [disabled]="!flgFechaConsultaHistorica"/>
                          </div>
                          <div class="col-xl-1 col-lg-4 col-md-2">
                            <label class="form-label">Fecha Fin:</label>
                          </div>
                          <div class="col-xl-4 col-lg-4 col-md-4">
                            <input class="form-control" type="date" placeholder="yyyy-mm-dd" [(ngModel)]="fechFin" ngbDatepicker (click)="d2.toggle()"
                              #d2="ngbDatepicker" name="t218_Date" readonly [disabled]="!flgFechaConsultaHistorica"
                            />
                          </div>
                        </div>
                        <span class="br"></span>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col d-flex justify-content-end">
                        <button
                          class="btn btn-green"
                          type="submit"
                          (click)="generarReporte(2)">
                          Aceptar
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
